{% style %}
  .faq-section-{{ section.id }} {
    padding: 60px 20px;
    background: {{ section.settings.background_color }};
  }

  .faq-container-{{ section.id }} {
    max-width: 1420px;
    width: 100%;
    background: white;
    border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    margin: 0 auto;
  }

  .faq-header-{{ section.id }} {
    color: {{ section.settings.heading_color }};
    padding: 20px 30px;
    text-align: center;
  }

  .faq-header-{{ section.id }} h1 {
    font-size: 2rem;
    margin-bottom: 10px;
  }

  .faq-header-{{ section.id }} p {
    font-size: 1.1rem;
    opacity: 0.9;
  }

  .faq-content-{{ section.id }} {
    padding: 30px;
  }

  .faq-item-{{ section.id }} {
    border-bottom: 1px solid #eaeaea;
    overflow: hidden;
  }

  .faq-question-{{ section.id }} {
    padding: 20px 0;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
  }

  .faq-question-{{ section.id }}:hover {
    color: {{ section.settings.accent_color }};
  }

  .faq-question-{{ section.id }} h3 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-right: 20px;
  }

  .faq-icon-{{ section.id }} {
    font-size: 1.2rem;
    transition: transform 0.3s ease;
    color: {{ section.settings.accent_color }};
    min-width: 20px;
  }

  .faq-answer-{{ section.id }} {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease, padding 0.3s ease;
    color: #555;
    line-height: 1.6;
  }

  .faq-answer-{{ section.id }} p {
    padding-bottom: 20px;
  }

  .faq-item-{{ section.id }}.active .faq-answer-{{ section.id }} {
    max-height: 500px;
  }

  .faq-item-{{ section.id }}.active .faq-icon-{{ section.id }} {
    transform: rotate(180deg);
  }

  .faq-item-{{ section.id }}.active .faq-question-{{ section.id }} {
    color: {{ section.settings.accent_color }};
  }

  .faq-footer-{{ section.id }} {
    text-align: center;
    padding: 20px;
    background: #f9f9f9;
    color: #777;
    font-size: 0.9rem;
  }

  .contact-link-{{ section.id }} {
    color: {{ section.settings.accent_color }};
    text-decoration: none;
    font-weight: 600;
  }

  .contact-link-{{ section.id }}:hover {
    text-decoration: underline;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .faq-header-{{ section.id }} h1 {
      font-size: 1.6rem;
    }
    
    .faq-header-{{ section.id }} p {
      font-size: 1rem;
    }
    
    .faq-content-{{ section.id }} {
      padding: 20px;
    }
    
    .faq-question-{{ section.id }} h3 {
      font-size: 1.1rem;
    }
  }

  @media (max-width: 480px) {
    .faq-header-{{ section.id }} {
      padding: 30px 20px;
    }
    
    .faq-header-{{ section.id }} h1 {
      font-size: 1.6rem;
    }
    
    .faq-question-{{ section.id }} {
      padding: 15px 0;
    }
    
    .faq-question-{{ section.id }} h3 {
      font-size: 1rem;
    }
  }
{% endstyle %}

<div class="faq-section-{{ section.id }}">
  <div class="faq-container-{{ section.id }}">
    <div class="faq-header-{{ section.id }}">
      <h1>{{ section.settings.heading | default: 'Frequently Asked Questions' }}</h1>
      {% if section.settings.subheading != blank %}
        <p>{{ section.settings.subheading }}</p>
      {% endif %}
    </div>
    
    <div class="faq-content-{{ section.id }}">
      {% for block in section.blocks %}
        <div class="faq-item-{{ section.id }}" {{ block.shopify_attributes }}>
          <div class="faq-question-{{ section.id }}">
            <h3>{{ block.settings.question }}</h3>
            <div class="faq-icon-{{ section.id }}">
              <i class="fas fa-chevron-down"></i>
            </div>
          </div>
          <div class="faq-answer-{{ section.id }}">
            <p>{{ block.settings.answer }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
    
    {% if section.settings.show_contact_link %}
      <div class="faq-footer-{{ section.id }}">
        <p>{{ section.settings.contact_text }} <a href="{{ section.settings.contact_link }}" class="contact-link-{{ section.id }}">{{ section.settings.contact_link_text }}</a></p>
      </div>
    {% endif %}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const sectionId = '{{ section.id }}';
  const faqItems = document.querySelectorAll('.faq-item-' + sectionId);
  
  if (faqItems.length === 0) return;
  
  // Add click event to each FAQ question
  faqItems.forEach(item => {
    const question = item.querySelector('.faq-question-' + sectionId);
    
    question.addEventListener('click', () => {
      // Check if we should close other items
      const closeOthers = {{ section.settings.close_others }};
      
      if (closeOthers) {
        // Close all other FAQ items
        faqItems.forEach(otherItem => {
          if (otherItem !== item && otherItem.classList.contains('active')) {
            otherItem.classList.remove('active');
          }
        });
      }
      
      // Toggle current FAQ item
      item.classList.toggle('active');
    });
  });
  
  // Auto-open first FAQ item if enabled
  {% if section.settings.auto_open_first and section.blocks.size > 0 %}
    faqItems[0].classList.add('active');
  {% endif %}
});
</script>

{% schema %}
{
  "name": "FAQ Section",
  "class": "faq-section",
  "max_blocks": 20,
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Find answers to the most common questions about our services"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Section Background Color",
      "default": "transparent"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent Color",
      "default": "#2575fc"
    },
    {
      "type": "checkbox",
      "id": "close_others",
      "label": "Close other FAQs when one opens",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "auto_open_first",
      "label": "Auto-open first FAQ",
      "default": false
    },
    {
      "type": "header",
      "content": "Contact Link"
    },
    {
      "type": "checkbox",
      "id": "show_contact_link",
      "label": "Show contact link",
      "default": true
    },
    {
      "type": "text",
      "id": "contact_text",
      "label": "Contact text",
      "default": "Still have questions?"
    },
    {
      "type": "text",
      "id": "contact_link_text",
      "label": "Contact link text",
      "default": "Contact our support team"
    },
    {
      "type": "url",
      "id": "contact_link",
      "label": "Contact link URL"
    }
  ],
  "blocks": [
    {
      "type": "faq",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How do I create an account on your platform?"
        },
        {
          "type": "textarea",
          "id": "answer",
          "label": "Answer",
          "default": "Creating an account is simple! Click on the \"Sign Up\" button at the top right of our homepage, fill in your details including your name, email address, and create a password. You'll receive a confirmation email to verify your account. Once verified, you can log in and start using our services."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Section",
      "category": "Text",
      "blocks": [
        {
          "type": "faq",
          "settings": {
            "question": "How do I create an account on your platform?",
            "answer": "Creating an account is simple! Click on the \"Sign Up\" button at the top right of our homepage, fill in your details including your name, email address, and create a password. You'll receive a confirmation email to verify your account. Once verified, you can log in and start using our services."
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "What payment methods do you accept?",
            "answer": "We accept all major credit cards (Visa, MasterCard, American Express), PayPal, and bank transfers for certain subscription plans. All payments are processed securely through our encrypted payment gateway to ensure your financial information is protected."
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "Can I cancel my subscription at any time?",
            "answer": "Yes, you can cancel your subscription at any time with no cancellation fees. When you cancel, you'll continue to have access to your subscription benefits until the end of your current billing cycle. You can cancel directly from your account settings or by contacting our support team."
          }
        }
      ]
    }
  ]
}
{% endschema %}