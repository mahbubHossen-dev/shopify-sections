{% comment %}
  Fashion Collage Grid — fully dynamic
  Layout matches: tall left + 4 mids + tall right (2 rows, 4 cols on desktop).
  You can place any block in any grid “area” using the “Position” select.

  Notes:
  - Use either Image Picker or External Image URL (external wins if present).
  - Buttons, overlay, and per-block overrides included.
{% endcomment %}

<section class="fashion-collage-grid color-{{ section.settings.color_scheme }}" id="section-{{ section.id }}">
 {% if section.settings.page_heading != blank -%}
    <div > <h2>{{ section.settings.page_heading }}</h2></div>
  {% endif %}  
  
  <div class="fcg-inner page-width" style="--fcg-gap: {{ section.settings.gap | default: 10 }}px; --fcg-radius: {{ section.settings.radius | default: 10 }}px; --fcg-row-h: {{ section.settings.row_height | default: 310 }}px;">
    <div class="fcg-grid fcg-layout-{{ section.settings.layout }}">

     

      {%- for block in section.blocks -%}
        {%- assign area = block.settings.area | default: 'a1' -%}
        {%- assign ext = block.settings.external_image | strip -%}
        {%- assign img = block.settings.image -%}
        {%- assign src = '' -%}
        {%- if ext != blank -%}
          {%- assign src = ext -%}
        {%- elsif img != blank -%}
          {%- assign src = img | image_url: width: 1600 -%}
        {%- endif -%}
        <a
          {{ block.shopify_attributes }}
          class="fcg-item {{ area }}"
          href="{{ block.settings.link | default: '#' }}"
          {% if block.settings.link == blank %}role="link" aria-disabled="true"{% endif %}
          {% if block.settings.new_tab %}target="_blank" rel="noopener"{% endif %}
          style="--ovr: {{ block.settings.overlay_opacity | default: section.settings.overlay_opacity }};
                 --btn-x: {{ block.settings.btn_x | default: '50%' }};
                 --btn-y: {{ block.settings.btn_y | default: '85%' }};
                 --ovc: {{ block.settings.overlay_color | default: section.settings.overlay_color }};"
        >
          <div class="fcg-media {% if section.settings.hover_zoom %}zoom{% endif %}">
            {%- if src != blank -%}
              <img
                src="{{ src }}"
                alt="{{ block.settings.alt | escape }}"
                loading="lazy"
                width="800" height="800"
              >
            {%- else -%}
              <div class="fcg-placeholder" aria-hidden="true">{{ 'image' | t }}</div>
            {%- endif -%}
            <span class="fcg-overlay"></span>
          </div>

          {%- if block.settings.button_text != blank -%}
            <span class="fcg-btn fcg-btn--{{ block.settings.button_style }}">
              {{ block.settings.button_text }}
            </span>
          {%- endif -%}
        </a>
      {%- endfor -%}
    </div>
  </div>

  <style>
    #section-{{ section.id }} .page-width{
      max-width: {% if section.settings.full_width %}100%{% else %}{{ section.settings.max_width }}px{% endif %};
      margin-inline: auto;
      padding: {{ section.settings.padding_y }}px {{ section.settings.padding_x }}px;
    }

    #section-{{ section.id }} .fcg-grid{
      display: grid;
      gap: var(--fcg-gap);
    }

    /* Desktop layout: 4 columns, 2 rows */
    #section-{{ section.id }} .fcg-layout-A{
      grid-template-columns: repeat(4, 1fr);
      grid-auto-rows: var(--fcg-row-h);
      grid-template-areas:
        "a1 a2 a2 a3"
        "a6 a4 a5 a5";
    }
    /* You can switch layouts in settings; Layout B flips tall to right */
    #section-{{ section.id }} .fcg-layout-B{
      grid-template-columns: repeat(4, 1fr);
      grid-auto-rows: var(--fcg-row-h);
      grid-template-areas:
        "a2 a3 a3 a1"
        "a4 a5 a6 a1";
    }

    /* Base item */
    #section-{{ section.id }} .fcg-item{
      position: relative;
      display: block;
      border-radius: var(--fcg-radius);
      overflow: hidden;
      min-height: 120px;
      text-decoration: none;
      color: inherit;
    }

    #section-{{ section.id }} .fcg-item.a1{ grid-area: a1; }
    #section-{{ section.id }} .fcg-item.a2{ grid-area: a2; }
    #section-{{ section.id }} .fcg-item.a3{ grid-area: a3; }
    #section-{{ section.id }} .fcg-item.a4{ grid-area: a4; }
    #section-{{ section.id }} .fcg-item.a5{ grid-area: a5; }
    #section-{{ section.id }} .fcg-item.a6{ grid-area: a6; }

    #section-{{ section.id }} .fcg-media{
      width: 100%;
      height: 100%;
      position: absolute;
      inset: 0;
    }
    #section-{{ section.id }} .fcg-media img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform: scale(1);
      transition: transform .6s ease;
    }
    #section-{{ section.id }} .fcg-media.zoom img{
      will-change: transform;
    }
    #section-{{ section.id }} .fcg-item:hover .fcg-media.zoom img{
      transform: scale(1.05);
    }

    #section-{{ section.id }} .fcg-placeholder{
      width: 100%; height: 100%;
      background: #f2f2f2;
      display: grid; place-items: center;
      color: #999; font-size: 12px; letter-spacing: .08em;
      text-transform: uppercase;
    }

    /* Overlay */
    #section-{{ section.id }} .fcg-overlay{
      position: absolute; inset: 0;
      background: var(--ovc);
      opacity: var(--ovr);
      pointer-events: none;
      transition: opacity .3s ease;
    }
    #section-{{ section.id }} .fcg-item:hover .fcg-overlay{
      opacity: calc(var(--ovr) + 0.05);
    }

    /* Button */
    #section-{{ section.id }} .fcg-btn{
      position: absolute;
      left: var(--btn-x);
      top: var(--btn-y);
      transform: translate(-50%, -50%);
      padding: .6rem 1rem;
      font-size: .9rem;
      line-height: 1;
      border-radius: 999px;
      white-space: nowrap;
      transition: transform .2s ease, opacity .2s ease;
      backdrop-filter: saturate(130%) blur(2px);
    }
    #section-{{ section.id }} .fcg-btn--primary{
      background: {{ section.settings.button_bg }};
      color: {{ section.settings.button_color }};
      border: 1px solid transparent;
    }
    #section-{{ section.id }} .fcg-btn--outline{
      background: transparent;
      color: {{ section.settings.button_bg }};
      border: 1px solid {{ section.settings.button_bg }};
    }
    #section-{{ section.id }} .fcg-item:hover .fcg-btn{
      transform: translate(-50%, -50%) scale(1.02);
    }

    /* Tablet */
    @media (max-width: 990px){
      #section-{{ section.id }} .fcg-layout-A,
      #section-{{ section.id }} .fcg-layout-B{
        grid-template-columns: repeat(2, 1fr);
        grid-auto-rows: calc(var(--fcg-row-h) * .9);
        grid-template-areas:
          "a1 a2"
          "a1 a3"
          "a4 a5"
          "a6 a6";
      }
    }

    /* Mobile */
    @media (max-width: 640px){
      #section-{{ section.id }} .fcg-layout-A,
      #section-{{ section.id }} .fcg-layout-B{
        grid-template-columns: 1fr;
        grid-auto-rows: calc(var(--fcg-row-h) * .8);
        grid-template-areas:
          "a2"
          "a3"
          "a4"
          "a5"
          "a1";
      }
      #section-{{ section.id }} .fcg-btn{
        --btn-x: 50%; --btn-y: 88%;
        font-size: .85rem; padding: .55rem .9rem;
      }
    }
  </style>
</section>

{% schema %}
{
  "name": "Foods Grid",
  "tag": "section",
  "class": "fashion-collage-grid-wrapper",
  "settings": [
    {
      "type": "text",
      "id": "page_heading",
      "label": "Heading",
      "default": "Collection Gallery",
    },
    {
      "type": "text",
      "id": "page_descriptions",
      "label": "Description",
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Desktop layout",
      "default": "A",
      "options": [
        { "value": "A", "label": "Tall left (like reference)" },
        { "value": "B", "label": "Tall right (mirrored)" }
      ]
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full width",
      "default": false
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Max width (px)",
      "min": 800, "max": 1800, "step": 20,
      "default": 1400
    },
    {
      "type": "range",
      "id": "row_height",
      "label": "Row height (desktop, px)",
      "min": 220, "max": 520, "step": 10,
      "default": 320
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Gap (px)",
      "min": 0, "max": 30, "step": 1,
      "default": 10
    },
    {
      "type": "range",
      "id": "radius",
      "label": "Corner radius (px)",
      "min": 0, "max": 36, "step": 1,
      "default": 12
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Default overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Default overlay opacity",
      "min": 0, "max": 100, "step": 5,
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "hover_zoom",
      "label": "Hover zoom image",
      "default": true
    },
    {
      "type": "color",
      "id": "button_bg",
      "label": "Primary button background",
      "default": "#111111"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Primary button text",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "padding_x",
      "label": "Section padding X",
      "min": 0, "max": 60, "step": 2,
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_y",
      "label": "Section padding Y",
      "min": 0, "max": 80, "step": 2,
      "default": 20
    }
  ],
  "blocks": [
    {
      "type": "grid_item",
      "name": "Grid item",
      "limit": 12,
      "settings": [
        {
          "type": "select",
          "id": "area",
          "label": "Position (desktop area)",
          "default": "a1",
          "options": [
            { "value": "a1", "label": "Tall column A1" },
            { "value": "a2", "label": "Top small A2" },
            { "value": "a3", "label": "Top wide A3" },
            { "value": "a4", "label": "Bottom small A4" },
            { "value": "a5", "label": "Bottom small A5" },
            { "value": "a6", "label": "Bottom small A6" }
          ],
          "info": "Drag blocks to reorder, or drop them into areas."
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "external_image",
          "label": "External image URL (optional)",
          "info": "If set, this overrides the uploaded image."
        },
        {
          "type": "text",
          "id": "alt",
          "label": "Image alt text",
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link (optional)"
        },
        {
          "type": "checkbox",
          "id": "new_tab",
          "label": "Open link in new tab",
          "default": false
        },
        {
          "type": "color",
          "id": "overlay_color",
          "label": "Overlay color (override)",
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "Overlay opacity (override)",
          "min": 0, "max": 100, "step": 5,
          "default": 0
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text (optional)",
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link (optional)",
          "info": "Uses the main link if empty."
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "Button style",
          "default": "primary",
          "options": [
            { "value": "primary", "label": "Primary" },
            { "value": "outline", "label": "Outline" }
          ]
        },
        {
          "type": "text",
          "id": "btn_x",
          "label": "Button X position",
          "default": "50%",
          "info": "Use CSS units (e.g., 50%, 32px)."
        },
        {
          "type": "text",
          "id": "btn_y",
          "label": "Button Y position",
          "default": "85%",
          "info": "Use CSS units (e.g., 85%, 24px)."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Foods Grid",
      "blocks": [
        { "type": "grid_item", "settings": { "area": "a1" } },
        { "type": "grid_item", "settings": { "area": "a2" } },
        { "type": "grid_item", "settings": { "area": "a3" } },
        { "type": "grid_item", "settings": { "area": "a4" } },
        { "type": "grid_item", "settings": { "area": "a5" } },
        { "type": "grid_item", "settings": { "area": "a6" } }
      ]
    }
  ]
}
{% endschema %}

{% stylesheet %}{% endstylesheet %}
{% javascript %}{% endjavascript %}
